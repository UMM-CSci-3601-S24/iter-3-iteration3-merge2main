{
  # We expect this environment variable to be a valid Caddy global config
  # for example, "email user@example.com" or "auto_https off"
  {$CADDY_GLOBAL_OPTIONS}
}

{
  {$CADDY_GLOBAL_OPTIONS}
}

{$CADDY_HOST}

route {
    reverse_proxy /api* server:4567
    reverse_proxy @websockets server:4567
    try_files {path} {path}/ /
    file_server
}

@websockets {
    header Connection *Upgrade*
    header Upgrade websocket
}

@static {
  file
  path *.ico *.css *.js *.gif *.jpg *.jpeg *.png *.svg *.webp *.woff *.woff2 *.ttf *.otf *.eot
}

header @static Cache-Control max-age=5184000

encode zstd gzip